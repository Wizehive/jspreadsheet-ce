<script type="text/javascript" src="index.js"></script>
<link rel="stylesheet" href="jspreadsheet.css" type="text/css" />

<script src="https://jsuites.net/v4/jsuites.js"></script>
<link
  rel="stylesheet"
  href="https://jsuites.net/v4/jsuites.css"
  type="text/css"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Material+Icons"
/>

<link
  rel="stylesheet"
  type="text/css"
  href="http://weareoutman.github.io/clockpicker/dist/jquery-clockpicker.min.css"
/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="http://weareoutman.github.io/clockpicker/dist/jquery-clockpicker.min.js"></script>

<div id="spreadsheet"></div>

<script>
  var data2 = [
    ["PHP", "14:00"],
    ["Javascript", "16:30"],
  ];

  var customColumn = {
    // Methods
    closeEditor: function (cell, save) {
      var value = cell.children[0].value;
      cell.innerHTML = value;
      return value;
    },
    openEditor: function (cell) {
      // Create input
      var element = document.createElement("input");
      element.value = cell.innerHTML;
      // Update cell
      cell.classList.add("editor");
      cell.innerHTML = "";
      cell.appendChild(element);
      $(element).clockpicker({
        afterHide: function () {
          setTimeout(function () {
            // To avoid double call
            if (cell.children[0]) {
              myTable.closeEditor(cell, true);
            }
          });
        },
      });
      // Focus on the element
      element.focus();
    },
    getValue: function (cell) {
      console.log("cell", cell);
      return cell.innerHTML;
    },
    setValue: function (cell, value) {
      cell.innerHTML = value;
    },
  };

  myTable = jspreadsheet(document.getElementById("spreadsheet"), {
    data: data2,
    columns: [
      { type: "text", title: "Course Title", width: 300 },
      { type: "text", title: "Time", width: 100, editor: customColumn },
      { type: "text", title: "Course Title", width: 300 },
      { type: "text", title: "Course Title", width: 300 },
      { type: "text", title: "Course Title", width: 300 },
    ],
    toolbar: [
      {
        type: "i",
        content: "undo",
        tooltip: "undo",
        onclick: function () {
          myTable.undo();
        },
        group: "history",
      },
      {
        type: "i",
        content: "redo",
        tooltip: "redo",
        onclick: function () {
          jRef.current.jexcel.redo();
        },
        group: "history",
      },
      {
        type: "i",
        content: "lock",
        tooltip: "Freeze",
        onclick: function () {
          console.log("Freeze");
          // jRef.current.jexcel.freeze()
        },
      },
      {
        type: "select",
        tooltip: "data-type",
        k: "data-type",
        v: ["Text", "Number", "Date"], // Custom data type options
      },
      {
        type: "select",
        k: "font-family",
        v: ["Arial", "Verdana"],
      },
      {
        type: "select",
        k: "font-size",
        v: [
          "9px",
          "10px",
          "11px",
          "12px",
          "13px",
          "14px",
          "15px",
          "16px",
          "17px",
          "18px",
          "19px",
          "20px",
        ],
      },
      {
        type: "i",
        content: "format_align_left",
        k: "text-align",
        v: "left",
      },
      {
        type: "i",
        content: "format_align_center",
        k: "text-align",
        v: "center",
      },
      {
        type: "i",
        content: "format_align_right",
        k: "text-align",
        v: "right",
      },
      {
        type: "i",
        content: "format_align_justify",
        k: "text-align",
        v: "justify",
      },
      {
        type: "i",
        content: "format_bold",
        k: "font-weight",
        v: "bold",
      },
      {
        type: "i",
        content: "format_italic",
        k: "font-style",
        v: "italic",
      },
      {
        type: "i",
        content: "format_underline",
        k: "text-decoration",
        v: "underline",
      },
      {
        type: "i",
        content: "strikethrough_s",
        k: "text-decoration",
        v: "line-through",
      },

      {
        type: "color",
        content: "format_color_text",
        k: "color",
      },
      {
        type: "color",
        content: "format_color_fill",
        k: "background-color",
      },
    ],
    onselection: function (
      el,
      borderLeft,
      borderTop,
      borderRight,
      borderBottom
    ) {
      var columnStart = borderLeft;
      var columnEnd = borderRight;
      var rowStart = borderTop;
      var rowEnd = borderBottom;
      if (columnStart === columnEnd && rowStart === rowEnd) {
        // Single cell selected
        var columnName = String.fromCharCode(65 + columnStart);
        var cellAddress = columnName + (rowStart + 1);
        var cellValue = myTable.getValue(cellAddress, true);
        myTable.setCellIndication(cellAddress);
        myTable.setCellValue(cellValue);
      } else if (rowStart === rowEnd) {
        // Entire column selected
        var columnNameStart =
          String.fromCharCode(65 + columnStart) + (rowStart + 1);
        var columnNameEnd =
          String.fromCharCode(65 + columnEnd) + (rowStart + 1);
        var columnRangeAddress = columnNameStart + ":" + columnNameEnd;
        myTable.setCellIndication(columnRangeAddress);
      } else if (rowStart === 0 && rowEnd === 0 && columnStart !== columnEnd) {
        // Range of columns selected
        var columnNameStart =
          String.fromCharCode(65 + columnStart) + (rowStart + 1);
        var columnNameEnd = String.fromCharCode(65 + columnEnd) + (rowEnd + 1);
        var columnRangeAddress = columnNameStart + ":" + columnNameEnd;
        myTable.setCellIndication(columnRangeAddress);
      } else {
        // Multiple cells selected
        var selectedCells = [];

        // Iterate over the selected columns
        for (var col = columnStart; col <= columnEnd; col++) {
          var columnName = String.fromCharCode(65 + col);
          selectedCells.push(
            columnName + (rowStart + 1) + ":" + columnName + (rowEnd + 1)
          );
        }
        myTable.setCellIndication(selectedCells.join(", "));
      }
    },
    allowManualInsertRow: false,
    allowInsertRow: false,
    allowManualInsertColumn: false,
    disableToolBar: true
  });
</script>
